<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="wkevin RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="wkevin Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="wkevin JSON Feed">
<link rel="stylesheet" href="/katex/katex.min.css"><title data-rh="true">Python代码风格和美化工具 | wkevin</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wkevin.github.io/blog/2019/05/28/pep8"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Python代码风格和美化工具 | wkevin"><meta data-rh="true" name="description" content=" "><meta data-rh="true" property="og:description" content=" "><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2019-05-28T17:23:15.000Z"><meta data-rh="true" property="article:author" content="http://weibo.com/wkevin27"><meta data-rh="true" property="article:tag" content="PEP,Python,Black,YAPF"><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://wkevin.github.io/blog/2019/05/28/pep8"><link data-rh="true" rel="alternate" href="https://wkevin.github.io/blog/2019/05/28/pep8" hreflang="en"><link data-rh="true" rel="alternate" href="https://wkevin.github.io/blog/2019/05/28/pep8" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.a44d9312.css">
<link rel="preload" href="/assets/js/runtime~main.8dd9c13a.js" as="script">
<link rel="preload" href="/assets/js/main.ba7894db.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="wkevin Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="wkevin Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">wKevin</b></a><a class="navbar__item navbar__link" href="/docs/stack/">技术栈</a><a class="navbar__item navbar__link" href="/docs/project/industry/">业务场</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog/tags">Tags</a><a class="navbar__item navbar__link" href="/blog/rss.xml">Feed</a><a href="https://github.com/wkevin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">Python代码风格和美化工具</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2019-05-28T17:23:15.000Z" itemprop="datePublished">May 28, 2019</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="http://weibo.com/wkevin27" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="/img/avastar/angry.bird-l.jpg" alt="wKevin"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="http://weibo.com/wkevin27" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">wKevin</span></a></div><small class="avatar__subtitle" itemprop="description">一颗向上的水滴</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><table><thead><tr><th>出品方</th><th>代码风格</th><th>美化工具</th></tr></thead><tbody><tr><td>Python</td><td><a href="https://www.python.org/dev/peps/pep-0008/" target="_blank" rel="noopener noreferrer">PEP8</a><br><a href="https://china-testing.github.io/python_pep8.html" target="_blank" rel="noopener noreferrer">网友译</a>, <a href="https://wkevin.github.io/it/pep8/" target="_blank" rel="noopener noreferrer">本人译</a></td><td><a href="https://github.com/python/black" target="_blank" rel="noopener noreferrer">Black</a></td></tr><tr><td>Google</td><td><a href="https://google.github.io/styleguide/pyguide.html" target="_blank" rel="noopener noreferrer">Google Python Style</a><br><a href="https://www.runoob.com/w3cnote/google-python-styleguide.html" target="_blank" rel="noopener noreferrer">网友译</a></td><td><a href="https://github.com/google/yapf" target="_blank" rel="noopener noreferrer">YAPF</a></td></tr></tbody></table><p>代码风格（Code Style）与编码规范还是有些差异，我以为：</p><ul><li><strong>代码风格</strong> 主要关注代码排版、一致性、易读性 —— <strong>至美</strong></li><li><strong>编码规范</strong> 概念更宏观，范畴更广泛，包括设计理念、性能优化、代码风格 —— <strong>至真、至善、至美</strong></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="psf--pep">PSF &amp; PEP<a class="hash-link" href="#psf--pep" title="Direct link to heading">​</a></h2><p>PSF（Python Software Foundation），Python 的官方组织。PSF 提供的文档包括：</p><ul><li><a href="https://docs.python.org/3/" target="_blank" rel="noopener noreferrer">Python Doc (API 手册)</a></li><li>Guide：<ul><li><a href="https://wiki.python.org/moin/BeginnersGuide" target="_blank" rel="noopener noreferrer">Beginner&#x27;s Guide</a></li><li><a href="https://devguide.python.org/" target="_blank" rel="noopener noreferrer">Developer’s Guide</a></li></ul></li><li>资源列表：PSF 收集的各种语言的学习、开发资源</li><li><a href="https://www.python.org/dev/peps/" target="_blank" rel="noopener noreferrer">PEP</a> ：Python Enhancement Proposals、Python 增强建议书</li></ul><p>PEP 是 PSF 写出、收纳、提供给社区参考使用、包含新特性、规范性等内容的说明文档。</p><p>PEP 在<a href="https://github.com/python/peps" target="_blank" rel="noopener noreferrer">github</a>上撰写、管理，自动编译 html、同步到<a href="https://www.python.org/dev/peps/" target="_blank" rel="noopener noreferrer">网站</a>上，从 2000 年开始创建，至今（2019.5）仍非常活跃，如果是 python 的 developer，建议 star 或 watch 它，实时跟踪。</p><p>PEP 分了 8 类：<strong>核心类、已提交、已接收、讨论中、讨论完、归档、拒绝、废弃</strong>。</p><ul><li>有些 pep 很庞大，如：pep8（python 代码风格）；也有些很简短，如：pep7（c 代码风格）</li><li>有些 pep 很一本正经，如：pep569（Python 3.8 Release Schedule）；有些也很搞怪，如：pep20（Zen of Python，20 条禅学）</li></ul><p>要贡献 PEP，需要参考 pep12 的模板来写，并且 PEP 不是用 markdown 写的，而是 ReStructuredText，也是标记（markup）语言，语法比 markdown 稍复杂一点点，这里有一些语法说明：</p><ul><li><a href="http://docutils.sourceforge.net/docs/rst/quickstart.html" target="_blank" rel="noopener noreferrer">A ReStructuredText Primer</a></li><li><a href="http://docutils.sourceforge.net/docs/rst/quickref.html" target="_blank" rel="noopener noreferrer">Quick reStructuredText</a></li><li><a href="http://docutils.sourceforge.net/spec/rst/reStructuredText.html" target="_blank" rel="noopener noreferrer">reStructuredText Markup Specification</a></li></ul><p>普通 Python 开发人员必读的 PEP 有：</p><ul><li>代码风格<ul><li><a href="https://www.python.org/dev/peps/pep-0008/" target="_blank" rel="noopener noreferrer">PEP8</a>：Python 代码风格</li><li><a href="https://www.python.org/dev/peps/pep-0007/" target="_blank" rel="noopener noreferrer">PEP7</a>：C 编码规范</li></ul></li><li>文档规范<ul><li><a href="https://www.python.org/dev/peps/pep-0256/" target="_blank" rel="noopener noreferrer">PEP256</a>：文档系统工作机制</li><li><a href="https://www.python.org/dev/peps/pep-0257/" target="_blank" rel="noopener noreferrer">PEP257</a>：docstrings Conventions</li><li><a href="https://www.python.org/dev/peps/pep-0258/" target="_blank" rel="noopener noreferrer">PEP258</a>：注释与文档转换工具</li><li><a href="https://www.python.org/dev/peps/pep-0287/" target="_blank" rel="noopener noreferrer">PEP287</a>：reStructuredText 书写规则</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="pep8-style-guide-for-python-code">PEP8 Style Guide for Python Code<a class="hash-link" href="#pep8-style-guide-for-python-code" title="Direct link to heading">​</a></h2><p>核心类 pep 是 PEPs of PEPs，目前只有 9 个，<strong><a href="https://www.python.org/dev/peps/pep-0008/" target="_blank" rel="noopener noreferrer">PEP8</a></strong> 位列其中，内容是 Python 的代码风格（Code Style），Python 开发人员必读文档之一。</p><p>PEP8 从 2001 年创建，至今有 141 次提交：</p><p><img loading="lazy" src="data:image/png;base64,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" width="480" height="48" class="img_E7b_"></p><p>修改（提交）集中在 2002、 2012~2016 年，2019 已相对稳定：</p><p><img loading="lazy" src="/assets/images/pep8-commit-years-0c2a4a5845b426dacfec49c3976e14f8.png" width="917" height="401" class="img_E7b_"></p><p>参与撰写的人不少，但 top3 都是 python 官方的人：</p><p><img loading="lazy" src="/assets/images/pep8-contributors-a501ddd70307bf0f601025542c0e59d3.png" width="428" height="158" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="pep8-极简版">PEP8 极简版<a class="hash-link" href="#pep8-极简版" title="Direct link to heading">​</a></h2><p>PEP8 有网友翻译：<a href="https://china-testing.github.io/python_pep8.html" target="_blank" rel="noopener noreferrer">python 代码风格指南(PEP8 中文版)</a>，目前最后更新时间 2018.8。</p><p>下面我来根据 2019.5 的 PEP8，整理一份极简版，相比上面的网友翻译，增补了：</p><ul><li>Module 级 dunder</li><li>尾随逗号</li></ul><p><strong>极简版正文：</strong></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="写可读的代码">写“可读的代码”<a class="hash-link" href="#写可读的代码" title="Direct link to heading">​</a></h3><p>代码的使用频率上看：读取远大于编写，所以一定要写“可读的代码”</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="每级缩进-4-空格不允许-tab-和空格混用">每级缩进 4 空格，不允许 tab 和空格混用<a class="hash-link" href="#每级缩进-4-空格不允许-tab-和空格混用" title="Direct link to heading">​</a></h3><p>入参和 if 分开讨论</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 函数定义的入参比函数名多1级缩进</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">def long_function_name(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var_one, var_two, var_three,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var_four):</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    print(var_one)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 函数调用的入参可对准左括号 or 悬挂缩进1级</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">foo = long_function_name(var_one, var_two,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                         var_three, var_four)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">foo = long_function_name(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var_one, var_two,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var_three, var_four)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># if条件语句跨行时缩进：加1级即可</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">if (this_is_one_thing</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        and that_is_another_thing):</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    do_something()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="最大行宽79-字符文本块-72-字符极限-99-字符">最大<strong>行宽</strong>79 字符，文本块 72 字符，极限 99 字符<a class="hash-link" href="#最大行宽79-字符文本块-72-字符极限-99-字符" title="Direct link to heading">​</a></h3><ul><li>以前通常在二元运算符（+-<!-- -->*<!-- -->/ and or...）之后续行</li><li>现在推荐在二元运算符之前续行</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">income = (gross_wages</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          + taxable_interest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          + (dividends - qualified_dividends)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          - ira_deduction</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          - student_loan_interest)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="空行要尽量节约使用"><strong>空行</strong>要尽量节约使用<a class="hash-link" href="#空行要尽量节约使用" title="Direct link to heading">​</a></h3><ul><li>顶层函数和 Class 之间可以用 2 个空行</li><li>Class 内的方法之间用 1 个空行</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="源文件字符编码尽量使用-utf-8">源文件<strong>字符编码</strong>尽量使用 utf-8<a class="hash-link" href="#源文件字符编码尽量使用-utf-8" title="Direct link to heading">​</a></h3><ul><li>ASCII 和 utf-8 的源文件不需要“编码声明”</li><li>标准库更严格：符号<strong>必须</strong>用 ASCII，其他<strong>尽量</strong>英文字母</li><li>注释 or 字符串可以用非 ASCII 字符 <code>\x \u \U \N</code></li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">: str1=&#x27;\xE4&#x27;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">: print(str1)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ä</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">: str2 = &#x27;\u4f60\u597d&#x27;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">: print(str2)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">你好</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">: str3=&#x27;你好&#x27;.encode(&#x27;unicode-escape&#x27;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">: print(str3)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">b&#x27;\\u4f60\\u597d&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="import-每行导入-1-个模块">import 每行导入 1 个模块<a class="hash-link" href="#import-每行导入-1-个模块" title="Direct link to heading">​</a></h3><ul><li>import 要有顺序：标准库进口,第三方库,本地库 —— 各组的导入之间要有空行</li><li>禁止使用通配符导入 <code>from xxx import *</code></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="module-级-dunder-必须在__future__之后其他-import-之前">Module 级 dunder 必须在<code>__future__</code>之后，其他 import 之前<a class="hash-link" href="#module-级-dunder-必须在__future__之后其他-import-之前" title="Direct link to heading">​</a></h3><ul><li>dunder (double underscore, 双下划线)</li><li>最早 python 对<code>__all__</code>这种符号称为魔法变量、魔法函数，后来为了破除迷信，称为 double underscore method，但太长了，被简称为 dunder symbol、dunder method……</li><li>Module 级的 dunder 有 2 个约束<ul><li>必须在 <code>from __future__ import ...</code> 后面</li><li>必须在其他 import 前面</li></ul></li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">from __future__ import barry_as_FLUFL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">__all__ = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">__version__ = &#x27;0.1&#x27;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">__author__ = &#x27;Cardinal Biggles&#x27;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import os</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import sys</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="python-字符串的单引号与双引号等效">python 字符串的单引号与双引号等效<a class="hash-link" href="#python-字符串的单引号与双引号等效" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_mojV" id="空格的讲究有很多">空格的讲究有很多<a class="hash-link" href="#空格的讲究有很多" title="Direct link to heading">​</a></h3><ul><li>括号（圆括号、方括号）内避免空格<ul><li>左括号之前避免空格</li></ul></li><li>逗号、冒号、分号之前避免空格，之后可有<ul><li>索引中的冒号前后都要避免空格</li></ul></li><li>赋值等操作符前后不能因为对齐而添加多个空格</li><li>二元运算符两边放置一个空格<ul><li>优先级高的运算符或操作符的前后不建议有空格</li><li>关键字参数和默认值参数的前后不要加空格</li></ul></li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 错误示范：</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">spam( ham[ 1 ], { eggs: 2 } ) # 括号里面太多空格</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ham[1: 9], ham[1 :9], ham[1:9 :3] # 索引冒号前后不应有空格</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">long_variable = 3</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">x             = 1  # 不能为了对齐等号而加空格</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">i=i+1 # =和+左右都要有空格</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">submitted +=1 # += 右边没有空格</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">x = x * 2 - 1 # *优先级高，左右不应有空格</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">def complex(real, imag = 0.0): # 默认参数的=左右不能有空格</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return magic(r = real, i = imag)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="function-annotations-前后有空格和-前无后有">function annotations <code>=</code>前后有空格，<code>:</code>和<code>-&gt;</code>前无后有<a class="hash-link" href="#function-annotations-前后有空格和-前无后有" title="Direct link to heading">​</a></h3><p>python3 中引入了 function annotations，它是一种注释性质的语法，用于声明入参的类型和默认值。</p><ul><li>2006 年的 <a href="https://www.python.org/dev/peps/pep-3107" target="_blank" rel="noopener noreferrer">PEP3107</a> 首先定义了 Function Annotations</li><li>2014 年的 <a href="https://www.python.org/dev/peps/pep-0484/" target="_blank" rel="noopener noreferrer">PEP484</a> 补充和修订了 Function Annotations</li><li>2016 年，又发展出了 <a href="https://www.python.org/dev/peps/pep-0526/" target="_blank" rel="noopener noreferrer">PEP526</a>，定义了 Variable Annotations</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import enforce</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">@enforce.runtime_validation</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">def add_int(a: int, b: int = 0)-&gt; int:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return a + b</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">print(add_int.__annotations__)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>表明入参 a 是 int 型，b 是 int 型且默认值 0，返回值 int 型</li><li><code>func.__annotations__</code> 返回函数入参注释信息</li><li>有@enforce 则强制类型检查，不匹配报错；不加 @enforce 则只做告警，不报错</li><li>function annotations 的代码风格要求<ul><li>=前后要有空格</li><li>冒号和&quot;-&gt;&quot;的前无，后有。</li></ul></li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">def add_int(a:int, b: int=0) -&gt; int: # 错误示范，有3处错误</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">def add_int(a: int, b: int = 0)-&gt; int: # 正确示范</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="尾随逗号在-tuple-中重要list-中无效分行中有利单行中冗余">尾随逗号在 Tuple 中重要，List 中无效；分行中有利，单行中冗余<a class="hash-link" href="#尾随逗号在-tuple-中重要list-中无效分行中有利单行中冗余" title="Direct link to heading">​</a></h3><p>尾随逗号（Trailing Commas）</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">FILES0 = (&#x27;setup.cfg&#x27;)  # 0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">FILES1 = (&#x27;setup.cfg&#x27;,) # 1</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">FILES2 = &#x27;setup.cfg&#x27;,   # 2</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">FILES3 = [&#x27;setup.cfg&#x27;, &#x27;tox.ini&#x27;]    # 3</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">FILES4 = [&#x27;setup.cfg&#x27;, &#x27;tox.ini&#x27;, ]  # 4</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">FILES5 = [                           # 5</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &#x27;setup.cfg&#x27;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &#x27;tox.ini&#x27;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>类型:0 是 str，1/2 是 tuple，3/4 是 list</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">: print(type(FILES0),type(FILES1),type(FILES2),type(FILES3),type(FILES4))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;class &#x27;str&#x27;&gt; &lt;class &#x27;tuple&#x27;&gt; &lt;class &#x27;tuple&#x27;&gt; &lt;class &#x27;list&#x27;&gt; &lt;class &#x27;list&#x27;&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>1==2 —— Tuple 中尾随逗号是重要的</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">In [42]: FILES1==FILES2</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Out[42]: True</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>3==4==5 —— List 中尾随逗号是无效的</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">In [43]: FILES3==FILES4==FILES5</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Out[43]: True</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>5 中每行增加尾随逗号是有意义的，可以减少新增行时的工作量</li><li>4 中单行增加尾随逗号是没有意义的。</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="注释书写规范参考-pep257">注释书写规范参考 PEP257<a class="hash-link" href="#注释书写规范参考-pep257" title="Direct link to heading">​</a></h3><ul><li>与代码自相矛盾的注释比没注释更差。修改代码时要优先更新注释！</li><li>注释段落中的每个句子应该以句号+2 个空格结束。</li><li><strong>文档化注释</strong>（或称为：可生成文档的注释）需遵守 PEP257<ul><li>将来有空可以单讲一篇，先挖个坑吧</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="命名可用一张表格说清">命名：可用一张表格说清<a class="hash-link" href="#命名可用一张表格说清" title="Direct link to heading">​</a></h3><p>程序猿常见的命名风格多样：</p><table><thead><tr><th>Naming Styles</th><th>举例</th><th>使用场景</th><th>备注</th></tr></thead><tbody><tr><td>单个小写字母</td><td>b</td><td>变量名</td><td>避免使用小写 l(易与 1,I 混)</td></tr><tr><td>单个大写字母</td><td>B</td><td>变量名</td><td>避免使用大写 O(易与 0 混)、I</td></tr><tr><td>小写串</td><td>lowercase</td><td>变量名，包名，模块名</td><td>模块名对应文件名，有线系统文件名不区分大小写</td></tr><tr><td>带下划线的小写</td><td>lower_case_with_underscores</td><td>函数名，类的公开方法</td><td></td></tr><tr><td>大写串</td><td>UPPERCASE</td><td>常量</td><td>通常在模块级别定义</td></tr><tr><td>带下划线的大写串</td><td>UPPER_CASE_WITH_UNDERSCORES</td><td>常量</td><td>同上</td></tr><tr><td><strong>驼峰命名法</strong><br>首字母大写的单词串</td><td>CapitalizedWords（CapWords）</td><td>Class 名</td><td>专有名次缩写可全大写，如 HTTP</td></tr><tr><td><strong>匈牙利命名法</strong><br>混合大小写，首单词小写</td><td>mixedCase</td><td></td><td>python 抵制<br>极少特殊情况下用于函数名</td></tr><tr><td>带下划线，首字母大写</td><td>Capitalized_Words_With_Underscores</td><td></td><td>python 抵制，丑陋</td></tr><tr><td>短前缀分组+匈牙利或驼峰</td><td>bsp_getPower</td><td></td><td>python 抵制，与 C 划清界限</td></tr><tr><td>单前置下划线</td><td>_<!-- -->single_leading_underscore</td><td>用于不想被外部使用的全局变量<br>或局部变量<br>类的非公开方法和实例变量</td><td>弱内部使用<br>weak &quot;internal use&quot;</td></tr><tr><td>单后置下划线</td><td>single<em>trailing_underscore</em></td><td><code>def func(class_=&#x27;name&#x27;)</code></td><td>用于避免与 Python 关键词的冲突</td></tr><tr><td>双前置下划线</td><td><code>__double_leading_underscore</code></td><td>类 Foo 中的<code>__bar</code>会变成<code>_Foo__bar</code></td><td>当用于命名类属性，会触发名字重整</td></tr><tr><td>双前后下划线</td><td><code>__dunder_func__</code></td><td>Dunder（魔法）函数</td><td>不要自己发明这样的名字</td></tr></tbody></table><ul><li>Python 中没有属性是真正私有的，所以没有 private 方法。</li><li>简单的公开数据属性，最好只公开属性名，没有复杂的访问/修改方法，python 的 Property 提供了很好的封装方法。</li><li>为了更好地支持内省，模块要在<code>__all__</code>属性列出公共 API。</li><li>如果命名空间(包、模块或类)是内部的，里面的接口也是内部的。</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="编程建议">编程建议<a class="hash-link" href="#编程建议" title="Direct link to heading">​</a></h3><p>下面就不单纯是格式（format）的问题了，而是有利于程序运行的内容。</p><ul><li>要明白自己在用哪个 python 解释器<ul><li><a href="https://wiki.python.org/moin/PythonImplementations" target="_blank" rel="noopener noreferrer">官方整理出来好几十个</a><ul><li>CPython: <a href="https://www.python.org/downloads/" target="_blank" rel="noopener noreferrer">https://www.python.org/downloads/</a> 官网下载的既是</li><li>CPython 衍生的 stacklessPython, wpython, microPython...</li><li><a href="https://pypy.org/" target="_blank" rel="noopener noreferrer">PyPy</a>：Python in Python</li><li><a href="https://www.jython.org/" target="_blank" rel="noopener noreferrer">Jython</a>：Python in Java</li><li><a href="https://ironpython.net/" target="_blank" rel="noopener noreferrer">IronPython</a>：Python in C#</li><li><a href="https://www.activestate.com/products/activepython/" target="_blank" rel="noopener noreferrer">ActivePython</a></li><li><a href="http://winpython.github.io/" target="_blank" rel="noopener noreferrer">WinPython</a></li></ul></li><li>CPython 及其衍生底层是用 C 实现的，所以对 C/Python API 都有完美支持。非 C 语言实现的编译器虽然某些操作会快一些，但最大的问题是不支持某些只有 C 接口的库，如：numpy、scipy……</li><li>不同的编译器之间效率有差别，官方建议你仔细研究、斟酌</li></ul></li><li><code>if foo is not None</code> 优于 <code>if not foo is None</code></li><li><code>if foo == None</code> 用法错误</li><li>比较排序操作最好实现完整 6 个操作：<code>__eq__, __ne__, __lt__, __le__, __gt__, __ge__</code></li><li>变量赋值不要用 lambda，而要用 def，如：<code>f = lambda x: 2*x #不推荐</code></li><li>空&quot;except:&quot;子句(相当于 except Exception)会捕捉 SystemExit 和 KeyboardInterrupt 异常，难以用 Control-C 中断程序，并可掩盖其他问题。只适用于 2 种情况<ul><li>打印出或记录了 traceback，至少让用户将知道已发生错误</li><li>代码需要做一些清理工作，并用 raise 转发了异常，try...finally 可以捕捉到它</li></ul></li><li>本地资源用 with，使用 with 的资源要有独立的 enter、exit 方法</li><li>函数或者方法在没有返回时要明确返回 None</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">def foo(x):</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    if x &lt; 0:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return  # No！请 return None</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return math.sqrt(x)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>使用字符串方法而不是 string 模块<ul><li>Python 不支持单字符类型，单字符在 Python 中也是作为一个字符串</li></ul></li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 字符串方法</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; type(str)   # str是python关键字</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;class &#x27;type&#x27;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; STR=&quot;Hello World&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; type(STR)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;class &#x27;str&#x27;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; str.lower(STR)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&#x27;hello world&#x27;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; STR.lower() # str.xxx() == STR.xxx()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&#x27;hello world&#x27;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; STR[::-1]   # 翻转字符串</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&#x27;dlroW olleH&#x27;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; import string</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; STR = &quot;Hello {0}&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; f = string.Formatter()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; f.format(STR,&quot;world&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&#x27;Hello world&#x27;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; STR.format(&quot;World&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&#x27;Hello World</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>字符串方法中检查前后缀：使用 .startswith()和.endswith()代替字符串切片</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; STR[:5]==&quot;Hello&quot;        # 切片 —— No！</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">True</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&gt;&gt;&gt; STR.startswith(&quot;Hello&quot;) # Yes！</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">True</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>使用 isinstance()代替对象类型的比较</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">if isinstance(obj, int):    # Yes！</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">if type(obj) is type(1):    # No！</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>判断序列（字符串、list、tuple）为空：</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">if not seq:     # Yes!</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">if len(seq):    # No!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>不要用 == 进行布尔比较</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">if greeting:            # Yes!</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">if greeting == True     # No!</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">if greeting is True:    # Worse</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="自动代码美化工具">自动代码美化工具<a class="hash-link" href="#自动代码美化工具" title="Direct link to heading">​</a></h2><p>要实现 PEP8 中的大部分条目并不难，但要持之以恒、实现所有条目，应该还是挺难的。</p><p>一个人要实现 PEP8 中的条目并不难，但要保证一个团队都做到，应该还是挺难的。</p><p>如果有一个自动代码美化工具，当我 Ctrl-S 保存文件的时候实时帮我按 PEP8 美化一下，上面 2 个问题就都不是问题了。</p><p>帮我们实现这个愿望有：</p><ul><li>Google 出品的 <a href="https://github.com/google/yapf" target="_blank" rel="noopener noreferrer">YAPF</a> —— 可以满足你这方面的几乎所有需求。</li><li>Python 出品的 <a href="https://github.com/python/black" target="_blank" rel="noopener noreferrer">Black</a> —— 左手 Python，右手 Black，一家人做的东西靠得住。</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="yapf">YAPF<a class="hash-link" href="#yapf" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ pip install yapf</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ yapf [options] [files [files ...]]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>常用的 options 有：</p><ul><li><code>--diff</code>: 输出 diff 文件，不修改源文件</li><li><code>--style STYLE</code>:<ul><li>&quot;pep8&quot; or &quot;google&quot;</li><li>如果当前目录下有 .style.yapf 或 setup.cfg 文件，则从此文件中读取配置项<ul><li>配置项有几十个，各人慢慢研究</li></ul></li></ul></li></ul><p><code>.style.yapf</code> 文件示例：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">[yapf]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">based_on_style = pep8</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">spaces_before_comment = 4</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">split_before_logical_operator = true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="black">Black<a class="hash-link" href="#black" title="Direct link to heading">​</a></h3><p><img loading="lazy" src="https://raw.githubusercontent.com/python/black/master/docs/_static/logo2-readme.png" class="img_E7b_"></p><p>用了 Black，相当于放弃了自己的编码风格，完全由 Black 来接手，一个团队的代码就像一个人写的 —— 至少样子上是。</p><p>经过一段时间之后，个人手写水平也能提高，逐步逼近 PEP8 的要求。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ pip install black</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ black [options] [mypythonfile 或 dir]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>常用的 options 有：</p><ul><li><code>-t [py27|py33|py34|py35|py36|py37|py38]</code><ul><li>Black 会自动逐个试探每个文件的 python 版本，应用不同的风格</li></ul></li><li><code>--check</code>：只检查，不修改源文件</li><li><code>--diff</code>： 输出 diff 文件，不修改源文件</li><li><code>--include XXX</code>, <code>--exclude XXX</code>: 操作目录时的筛选器</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="比较">比较<a class="hash-link" href="#比较" title="Direct link to heading">​</a></h3><table><thead><tr><th>Item</th><th>YAPF</th><th>Black</th><th>点评</th></tr></thead><tbody><tr><td>License</td><td>Apache2.0</td><td>MIT</td><td>两者都允许修改后闭源，即允许只发布二进制版本，但必须附带 License。<br>Apache 要求每个文件头上都要附带，MIT 只需要根目录下放一份即可。</td></tr><tr><td>Author</td><td>Google</td><td>Python</td><td>所以 Black 只支持 PEP8，YAPF 则可定制</td></tr><tr><td>创建日期</td><td>2015-03-18</td><td>2018-03-14</td><td>3 月是个好季节</td></tr><tr><td>提交次数</td><td>1000+</td><td>500+</td><td>截至 2019.5</td></tr><tr><td>Github Star</td><td>9k+</td><td>10k+</td><td>截至 2019.5</td></tr></tbody></table><p>找一段代码实战比较一下，从左至右依次是：原始文件、black 处理后的文件、yapf 依 pep8 处理过的文件</p><p><img loading="lazy" src="/assets/images/compare-0fac67df6362cfce04054304d8f5a5c3.png" width="1233" height="757" class="img_E7b_"></p><ul><li>第 1 行：每次只 import1 个 model —— 没有帮我改过来</li><li>第 2 行：dunder 变量放置在 import 之前 —— 没有帮我改过来</li><li>第 9-18 行：空格、空行，black 和 yapf 都控制的不错<ul><li>第 17 行：google 把索引中的冒号两边去掉了空格</li></ul></li><li>第 19-23 行：因为没有超过 80 列，续行都合并到 1 行了</li><li>第 24-25 行：PEP8 中推荐的写法，black、yapf 都做了修正</li><li>第 28-32 行：PEP8 中推荐的写法，black 微调，yapf 大修 —— black 稍优</li><li>第 34 行：函数注释都能控制冒号左右的空格</li><li>第 37 行：要用 is 而不是==来比较 None —— 都没修改过来</li></ul><p>可以看出 black 和 yapf 能做的和 PEP8 比较还是有限，且目前都还在<strong>书写美化</strong>上下功夫，在<strong>代码优化</strong>上不足。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="合入-ide">合入 IDE<a class="hash-link" href="#合入-ide" title="Direct link to heading">​</a></h3><p>三层境界：</p><ol><li>代码美化频率较低或非强制的客官，实现功能，再绑定个快捷键，就够用了。</li><li>成为粉丝后，想要强制执行美化，对自己毫不留情的客官，就需要捆绑到“文件保存（Ctrl-S）”时自动执行。</li><li>强迫症患者或脑残粉，需要边写边美化的客官，就有上一些监控手段，各大 IDE 也都为你准备好了 Watcher 伺候。</li></ol><h4 class="anchor anchorWithStickyNavbar_mojV" id="vscode">VSCode<a class="hash-link" href="#vscode" title="Direct link to heading">​</a></h4><p>VSCode 目前是我的主力 Editor，合入 VSCode 是刚需。</p><p>为 black 命令创建一个 VSCode 的 Task（下图中我命名为： beautifu my python code），F1--Run Task 的时候选中即可，如下图：</p><p><img loading="lazy" src="/assets/images/task-86ab9dd201ce28117bd667699080aada.gif" width="1024" height="627" class="img_E7b_"></p><p>再绑定个快捷键就，爽快了：</p><p><img loading="lazy" src="/assets/images/keybinding-49bb35c4bdab2cc4fed5c9459b219c41.gif" width="1024" height="627" class="img_E7b_"></p><p>VSCode 可以将 Task 配置成 watching task，或使用 &quot;run on save&quot; 之类的 VSCode 扩展，可以实现“保存文件”或“其他动作”时自动执行美化 task。</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="pycharm">PyCharm<a class="hash-link" href="#pycharm" title="Direct link to heading">​</a></h4><p>PyCharm 的 Plugin 中可以搜到一个 black-pycharm 的插件，我试用了一下没玩转，还是自己配置吧。</p><p>首先在 Settings 中添加 External Tool：</p><p><img loading="lazy" src="/assets/images/pycharm-settings-externaltools-909b455a68052467c487de521e5bc115.png" width="1072" height="723" class="img_E7b_"></p><p>然后绑定到一个快捷键上：</p><p><img loading="lazy" src="/assets/images/pycharm-settings-keymap-6094eb119719ab4033f461ad931acd7a.png" width="1072" height="723" class="img_E7b_"></p><p>第 1 层境界练成！开始第 2 层：使用 pycharm 的一个 plugin： File Watcher 来实现，先添加插件，然后在 Tools 中添加一个 Watcher，如下图：</p><p><img loading="lazy" src="/assets/images/pycharm-settings-watcher-c3ad8f6173d8810c2ce1d1d6be16bdee.png" width="1072" height="723" class="img_E7b_"></p><p>使用效果：</p><p><img loading="lazy" src="/assets/images/pycharm-black-ctrl-s-f9edbeb36451332bdf947cdd753fb0b8.gif" width="747" height="506" class="img_E7b_"></p><p>Watcher 的配置中有一个 Auto-Edit 的选项请不要勾选，否则你将会进入第 3 境界，这种感觉我试了一下，非常酸爽：</p><p><img loading="lazy" src="/assets/images/pycharm-black-auto-0055b3881697a239ede4fa1b10cf88ee.gif" width="628" height="322" class="img_E7b_"></p><p>Good luck！</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/pep">PEP</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/python">Python</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/black">Black</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/yapf">YAPF</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2019/05/30/python.where"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Python 安装到哪 &amp; 从哪执行</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2019/05/22/floccus"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Floccus – 跨平台浏览器「书签同步」</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#psf--pep" class="table-of-contents__link toc-highlight">PSF &amp; PEP</a></li><li><a href="#pep8-style-guide-for-python-code" class="table-of-contents__link toc-highlight">PEP8 Style Guide for Python Code</a></li><li><a href="#pep8-极简版" class="table-of-contents__link toc-highlight">PEP8 极简版</a><ul><li><a href="#写可读的代码" class="table-of-contents__link toc-highlight">写“可读的代码”</a></li><li><a href="#每级缩进-4-空格不允许-tab-和空格混用" class="table-of-contents__link toc-highlight">每级缩进 4 空格，不允许 tab 和空格混用</a></li><li><a href="#最大行宽79-字符文本块-72-字符极限-99-字符" class="table-of-contents__link toc-highlight">最大<strong>行宽</strong>79 字符，文本块 72 字符，极限 99 字符</a></li><li><a href="#空行要尽量节约使用" class="table-of-contents__link toc-highlight"><strong>空行</strong>要尽量节约使用</a></li><li><a href="#源文件字符编码尽量使用-utf-8" class="table-of-contents__link toc-highlight">源文件<strong>字符编码</strong>尽量使用 utf-8</a></li><li><a href="#import-每行导入-1-个模块" class="table-of-contents__link toc-highlight">import 每行导入 1 个模块</a></li><li><a href="#module-级-dunder-必须在__future__之后其他-import-之前" class="table-of-contents__link toc-highlight">Module 级 dunder 必须在<code>__future__</code>之后，其他 import 之前</a></li><li><a href="#python-字符串的单引号与双引号等效" class="table-of-contents__link toc-highlight">python 字符串的单引号与双引号等效</a></li><li><a href="#空格的讲究有很多" class="table-of-contents__link toc-highlight">空格的讲究有很多</a></li><li><a href="#function-annotations-前后有空格和-前无后有" class="table-of-contents__link toc-highlight">function annotations <code>=</code>前后有空格，<code>:</code>和<code>-&gt;</code>前无后有</a></li><li><a href="#尾随逗号在-tuple-中重要list-中无效分行中有利单行中冗余" class="table-of-contents__link toc-highlight">尾随逗号在 Tuple 中重要，List 中无效；分行中有利，单行中冗余</a></li><li><a href="#注释书写规范参考-pep257" class="table-of-contents__link toc-highlight">注释书写规范参考 PEP257</a></li><li><a href="#命名可用一张表格说清" class="table-of-contents__link toc-highlight">命名：可用一张表格说清</a></li><li><a href="#编程建议" class="table-of-contents__link toc-highlight">编程建议</a></li></ul></li><li><a href="#自动代码美化工具" class="table-of-contents__link toc-highlight">自动代码美化工具</a><ul><li><a href="#yapf" class="table-of-contents__link toc-highlight">YAPF</a></li><li><a href="#black" class="table-of-contents__link toc-highlight">Black</a></li><li><a href="#比较" class="table-of-contents__link toc-highlight">比较</a></li><li><a href="#合入-ide" class="table-of-contents__link toc-highlight">合入 IDE</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a href="http://weibo.com/wkevin27" target="_blank" rel="noopener noreferrer" class="footer__link-item">微博</a></li><li class="footer__item"><a href="https://twitter.com/wkevin27" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://gitee.com/wkevin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee</a></li><li class="footer__item"><a href="https://blog.csdn.net/kevin881" target="_blank" rel="noopener noreferrer" class="footer__link-item">CSDN</a></li></ul></div><div class="col footer__col"><div class="footer__title">Awesome</div><ul class="footer__items"><li class="footer__item"><a href="https://arxiv.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Arxiv</a></li><li class="footer__item"><a href="https://www.tianlangbooks.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">天浪书屋</a></li><li class="footer__item"><a href="https://yts.mx/" target="_blank" rel="noopener noreferrer" class="footer__link-item">YTS</a></li></ul></div><div class="col footer__col"><div class="footer__title">Collaborate</div><ul class="footer__items"><li class="footer__item"><a href="https://mubu.com/app" target="_blank" rel="noopener noreferrer" class="footer__link-item">幕布</a></li><li class="footer__item"><a href="https://shimo.im/" target="_blank" rel="noopener noreferrer" class="footer__link-item">石墨</a></li><li class="footer__item"><a href="https://www.feishu.cn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">飞书</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 wkevin, built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8dd9c13a.js"></script>
<script src="/assets/js/main.ba7894db.js"></script>
</body>
</html>