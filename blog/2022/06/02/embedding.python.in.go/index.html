<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="wkevin RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="wkevin Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="wkevin JSON Feed">
<link rel="stylesheet" href="/katex/katex.min.css"><title data-rh="true">Go 调用 Python | wkevin</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wkevin.github.io/blog/2022/06/02/embedding.python.in.go"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Go 调用 Python | wkevin"><meta data-rh="true" name="description" content="embeddding python in golang"><meta data-rh="true" property="og:description" content="embeddding python in golang"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-06-02T00:00:00.000Z"><meta data-rh="true" property="article:author" content="http://weibo.com/wkevin27"><meta data-rh="true" property="article:tag" content="python,go"><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://wkevin.github.io/blog/2022/06/02/embedding.python.in.go"><link data-rh="true" rel="alternate" href="https://wkevin.github.io/blog/2022/06/02/embedding.python.in.go" hreflang="en"><link data-rh="true" rel="alternate" href="https://wkevin.github.io/blog/2022/06/02/embedding.python.in.go" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.18f5ecf7.css">
<link rel="preload" href="/assets/js/runtime~main.cf3587f7.js" as="script">
<link rel="preload" href="/assets/js/main.8fa2c20d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="wkevin Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="wkevin Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">wKevin</b></a><a class="navbar__item navbar__link" href="/docs/stack/">技术栈</a><a class="navbar__item navbar__link" href="/docs/project/industry/">业务场</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog/tags">Tags</a><a class="navbar__item navbar__link" href="/blog/rss.xml">Feed</a><a href="https://github.com/wkevin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">Go 调用 Python</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-06-02T00:00:00.000Z" itemprop="datePublished">June 2, 2022</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="http://weibo.com/wkevin27" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="/img/avastar/angry.bird-l.jpg" alt="wKevin"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="http://weibo.com/wkevin27" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">wKevin</span></a></div><small class="avatar__subtitle" itemprop="description">一颗向上的水滴</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>Go 怎么调用 Python？或者说 Python 怎么嵌入到 Go？—— 我要研究明白。</p><ul><li>方案 1：go -- RESTFul -- python<ul><li>RESTFul 需要 python 起一个 http server 进程，并且定义 RESTFul API。</li></ul></li><li>方案 2：go -- rpc -- python<ul><li>rpc 方案可用 grpc 或其他，但也是需要我单独启动一个 python 进程并开启 grpc server，go 中启动 grpc client。</li></ul></li><li>方案 3：go -- cgo/内存共享 -- python(C API)<ul><li>python 的解释器我们绝大多数人都是使用官方的 CPython，内核和解释器是用 C 实现的，可以用 C 代码方便的调用。</li><li>go 又和 C 是天然搭档，通过标准库中的 cgo 模块可以一行代码无缝调用 C</li></ul></li></ul><p>RESTFul 和 RPC 的网络调用方式更适合高度解耦的场景，cgo 或直接内存共享为效率而生 —— 我打算先摸索一下方案 3。一通搜索，找到了几篇好文章，都列在最后的<a href="#ref-doc">参考文档</a>了，总结下来要点是：</p><ul><li>理解 Extending Python With Go 与 Embedding Python into Go 之间的区别，即：扩展和嵌入。</li><li>cgo 向 go 暴露了 C 的原始调用，需要能够找到正确的头文件(python.h)和库文件(libpythonX.Y.a)，大家都用一个叫 pkg-config 的工具来查找。</li><li>基于 cgo 的方式，有热心网友做了更高层次的封装，如：<ul><li>封装 Python2 C API 的 <a href="https://github.com/sbinet/go-python" target="_blank" rel="noopener noreferrer">sbinet/go-python</a>、<a href="https://github.com/spikeekips/embedding-python-in-golang" target="_blank" rel="noopener noreferrer">spikeekips/embedding-python-in-golang</a></li><li>封装 Python3.7 C API 的 <a href="https://github.com/DataDog/go-python3" target="_blank" rel="noopener noreferrer">DataDog/go-python3</a>（已停止）及其 fork <a href="https://github.com/go-python/cpy3" target="_blank" rel="noopener noreferrer">go-python/cpy3</a>，但都仅限于 python3.7，并且已经多年不维护。</li></ul></li></ul><p>好吧，开始启程。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="python-的-extending-和-embedding">Python 的 Extending 和 Embedding<a class="hash-link" href="#python-的-extending-和-embedding" title="Direct link to heading">​</a></h2><p><img loading="lazy" src="/assets/images/Selection_014-459475125fa59b537a2eab1d35be085b.png#size80" width="1055" height="545" class="img_E7b_"></p><p>Python 官方文档首页有个主题：<a href="https://docs.python.org/3/extending/index.html" target="_blank" rel="noopener noreferrer">Extending and Embedding</a>，从 python2 至今 3.10，一直都在这里，其中内容分 2 块：</p><ul><li>Extending（扩展）：使用 C（而不是 python）编写 python 扩展模块。</li><li>Embedding（嵌入）：将 Python 解释器嵌入到另一个应用程序中，以用作扩展语言。</li></ul><p><img loading="lazy" src="/assets/images/python.extending.and.embedding-88dde1f9814ae51be1c548d1544bcb30.svg" width="564" height="432" class="img_E7b_"></p><p>画了个可能不是很准确的图，表达一下我对扩展和嵌入的理解。</p><ul><li>括号中的部分(<code>(Python/*.c)</code>、<code>(Lib/*.py)</code>)表示这些模块在 CPython 源码中的文件夹，及其实现语言。</li><li>大圆圈中的 Python Core 与 Parser、Objects、Moudules 等编译后生成 python 解释器(一般位于 <code>/usr/bin/python</code>)和 python 库（一般位于<code>/usr/lib/x86_64_linux-gnu/libpythonx.y.a</code>）,都是二进制文件。</li><li>标准库的 python 部分源码在 <code>Lib/*.py</code>，安装时不编译，以源码形式安装（一般位于<code>/usr/lib/pythonx.y/</code>）</li></ul><p>python3.8 可执行文件（解释器）：</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ file /usr/bin/python3.8</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">/usr/bin/python3.8: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=1f3df9df2b5e575fdee41890fe17f6de614f93f6, for GNU/Linux 3.2.0, stripped</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>对应的 python 库：</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ file /usr/lib/x86_64-linux-gnu/libpython3.8.a</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">./libpython3.8.a: symbolic link to ../python3.8/config-3.8-x86_64-linux-gnu/libpython3.8.a</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>原来是个软连接</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ file /usr/lib/python3.8/config-3.8-x86_64-linux-gnu/libpython3.8.a</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">/usr/lib/python3.8/config-3.8-x86_64-linux-gnu/libpython3.8.a: current ar archive</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>还是个压缩包</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ readelf -h /usr/lib/python3.8/config-3.8-x86_64-linux-gnu/libpython3.8.a |grep &quot;^File:*&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">File: /usr/lib/python3.8/config-3.8-x86_64-linux-gnu/libpython3.8.a(getbuildinfo.o)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">File: /usr/lib/python3.8/config-3.8-x86_64-linux-gnu/libpython3.8.a(acceler.o)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">File: /usr/lib/python3.8/config-3.8-x86_64-linux-gnu/libpython3.8.a(grammar1.o)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">File: /usr/lib/python3.8/config-3.8-x86_64-linux-gnu/libpython3.8.a(listnode.o)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">File: /usr/lib/python3.8/config-3.8-x86_64-linux-gnu/libpython3.8.a(node.o)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">File: /usr/lib/python3.8/config-3.8-x86_64-linux-gnu/libpython3.8.a(parser.o)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">......</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>170+ .o 合并而成，对应上图中的大圆圈中相应的 .c 文件。</p><p>所以我想表达的是：</p><ul><li>扩展：指的是 C 语言实现的与标准库 C 部分类似的，可以通过 C API 调用 Core、Object、Moudules，从而实现的功能扩展。<ul><li>相比 python 在上层基于标准库实现的扩展或模块，C 扩展可以实现更底层的功能，比如：实现新的内置对象类型、调用 C 的库函数和系统调用 —— 这都是 python 调用标准库而实现的扩展模块做不到的。</li><li>C 写的扩展也需要编译为二进制、连接后才能使用，不能像 python 一样由词法器、解释器运行期处理。</li><li>可以用 disutils 编译 C 扩展，如：<code>python setup.py build</code>，会自动调用 gcc 生成 .so 或 .o。</li><li>然后扩展也可以与其他 python 编写的扩展一样，发布到 pypi</li></ul></li><li>嵌入：指的是将 python 解释器嵌入到其他语言或 APP 中，不再是主进程，而是被其他语言（C、go 等）主进程调用的派成进程。</li><li>扩展和嵌入都是调用 C-API</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="让-gcc-找到-python">让 gcc 找到 python<a class="hash-link" href="#让-gcc-找到-python" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="pkg-config">pkg-config<a class="hash-link" href="#pkg-config" title="Direct link to heading">​</a></h3><p>pkg-config 是用来收集系统上已安装库的元数据的小工具，Linux、macOS、Windows 上都可以使用，可以用在向 gcc、make 等提供数据的场景。</p><p>对于库的开发人员来说，随库版本一起发布和安装 pkg-config 文件（<code>*.pc</code>）可以简化用户（gcc）寻找信息的方法和时间。</p><p>安装：</p><p>如果想从源码安装，可以到 <a href="https://www.freedesktop.org/wiki/Software/pkg-config/" target="_blank" rel="noopener noreferrer">官网</a> 上<a href="http://pkgconfig.freedesktop.org/releases/" target="_blank" rel="noopener noreferrer">下载源码</a>，或从 <a href="https://gitlab.freedesktop.org/pkg-config/pkg-config" target="_blank" rel="noopener noreferrer">这里</a>找到 git 库地址 <code>git clone https://gitlab.freedesktop.org/pkg-config/pkg-config.git</code>。然后 configuration、make...</p><p>但还是简单点，不折腾，安装二进制版本吧：</p><ul><li>Linux: 各大发行版都默认安装了，直接使用。</li><li>macOS: <code>brew -v install pkg-config</code></li><li>windows: 待研究，好像要用到 MinGW，那干脆直接用微软在 windows 内嵌的原生 Linux 算了。</li></ul><p>pkg-config 搜索 <code>*.pc</code> 文件的路径可以用下面名称查看：</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ pkg-config --variable pc_path pkg-config</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">/usr/local/lib/x86_64-linux-gnu/pkgconfig:/usr/local/lib/pkgconfig:/usr/local/share/pkgconfig:/usr/lib/x86_64-linux-gnu/pkgconfig:/usr/lib/pkgconfig:/usr/share/pkgconfig</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li><code>/usr/local/lib/x86_64-linux-gnu/pkgconfig</code></li><li><code>/usr/local/lib/pkgconfig</code></li><li><code>/usr/local/share/pkgconfig</code></li><li><code>/usr/lib/x86_64-linux-gnu/pkgconfig</code> —— 我的电脑这里有 280+ 个</li><li><code>/usr/lib/pkgconfig</code></li><li><code>/usr/share/pkgconfig</code> —— 40+ 个</li></ul><p>查看已经能够使用的库用下面的命令，比如查出 glib-2 库：</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ pkg-config --list-all | grep glib-2</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">glib-2.0                       GLib - C Utility Library</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>说明本机已经安装了 glib-2.0 库，可以使用了：</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ pkg-config --cflags glib-2.0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">-I/usr/include/glib-2.0 -I/usr/lib/x86_64-linux-gnu/glib-2.0/include</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ pkg-config --libs glib-2.0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">-lglib-2.0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>聚合到 gcc 或 make 中就可以这样</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ gcc `pkg-config --cflags glib-2.0` `pkg-config --libs glib-2.0` main.c -o main</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="python-的-pkg-config-数据">python 的 pkg-config 数据<a class="hash-link" href="#python-的-pkg-config-数据" title="Direct link to heading">​</a></h3><p>我本机安装了多个版本的 python，pkg-config 都可以找到：</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ pkg-config --list-all | grep python</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python2                        Python - Python library</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python-2.7                     Python - Python library</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python3                        Python - Build a C extension for Python</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python-3.8-embed               Python - Embed Python into an application</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python-3.8                     Python - Build a C extension for Python</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python3-embed                  Python - Embed Python into an application</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>还可以通过 <code>PKG_CONFIG_PATH</code> 环境变量增加搜索 <code>*.pc</code> 文件的路径，如新增我用 pyenv 安装的更多 python：</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ export PKG_CONFIG_PATH=~/.pyenv/versions/3.9.2/lib/pkgconfig</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>然后就可以找到 3.9 的 python 了：</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ pkg-config --list-all | grep python</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python2                        Python - Python library</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python-2.7                     Python - Python library</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python3                        Python - Build a C extension for Python</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python-3.8-embed               Python - Embed Python into an application</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python-3.9-embed               Python - Embed Python into an application</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python-3.8                     Python - Build a C extension for Python</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python-3.9                     Python - Build a C extension for Python</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">python3-embed                  Python - Embed Python into an application</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>你应该注意到了，每个 python 都有 2 个 pc 文件，根据其注释，明确表明了 2 个 pc 的用途：</p><ol><li>Build a C extension for Python —— 扩展</li><li>Embed Python into an application —— 嵌入</li></ol><p>所以当我们开发扩展 or 嵌入的时候，一定要使用相应的 pc 文件。</p><p>对比一下：</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ cat /usr/lib/x86_64-linux-gnu/pkgconfig/python3.pc</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># See: man pkg-config</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">prefix=/usr</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">exec_prefix=${prefix}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">includedir=${prefix}/include</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Name: Python</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Description: Build a C extension for Python</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Requires:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Version: 3.8</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Libs.private: -lcrypt -lpthread -ldl  -lutil -lm</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Libs:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Cflags: -I${includedir}/python3.8 -I${includedir}/x86_64-linux-gnu/python3.8</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ cat /usr/lib/x86_64-linux-gnu/pkgconfig/python3-embed.pc</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># See: man pkg-config</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">prefix=/usr</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">exec_prefix=${prefix}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">libdir=${exec_prefix}/lib</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">includedir=${prefix}/include</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Name: Python</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Description: Embed Python into an application</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Requires:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Version: 3.8</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Libs.private: -lcrypt -lpthread -ldl  -lutil -lm</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Libs: -L${libdir} -lpython3.8</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Cflags: -I${includedir}/python3.8</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>所以相同命令得到不同结果：</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ pkg-config --libs python3</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ pkg-config --libs python3-embed</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">-lpython3.8</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>扩展是不需要 Libs 配置参数，嵌入需要 —— 想想为什么？</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="python-的-flag-还能这样获取">python 的 flag 还能这样获取<a class="hash-link" href="#python-的-flag-还能这样获取" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ python3.9-config --cflags</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">-I/home/me/.pyenv/versions/3.9.2/include/python3.9 -I/home/me/.pyenv/versions/3.9.2/include/python3.9  -Wno-unused-result -Wsign-compare  -DNDEBUG -g -fwrapv -O3 -Wall</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ python3.8-config --ldflags</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">-L/usr/lib/python3.8/config-3.8-x86_64-linux-gnu -L/usr/lib  -lcrypt -lpthread -ldl  -lutil -lm -lm</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>比暴露给 pkg-config 的更完整。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="python-c-api">Python C API<a class="hash-link" href="#python-c-api" title="Direct link to heading">​</a></h2><p>待补充</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="cgo">cgo<a class="hash-link" href="#cgo" title="Direct link to heading">​</a></h2><p>待补充</p><p>cgo 是 go 官方标准库中的一个模块，<a href="https://pkg.go.dev/runtime/cgo" target="_blank" rel="noopener noreferrer">go doc</a> 中</p><table><thead><tr><th>C 语言类型</th><th>CGO 类型</th><th>Go 语言类型</th></tr></thead><tbody><tr><td>char</td><td>C.char</td><td>byte</td></tr><tr><td>singed char</td><td>C.schar</td><td>int8</td></tr><tr><td>unsigned char</td><td>C.uchar</td><td>uint8</td></tr><tr><td>short</td><td>C.short</td><td>int16</td></tr><tr><td>unsigned short</td><td>C.ushort</td><td>uint16</td></tr><tr><td>int</td><td>C.int</td><td>int32</td></tr><tr><td>unsigned int</td><td>C.uint</td><td>uint32</td></tr><tr><td>long</td><td>C.long</td><td>int32</td></tr><tr><td>unsigned long</td><td>C.ulong</td><td>uint32</td></tr><tr><td>long long int</td><td>C.longlong</td><td>int64</td></tr><tr><td>unsigned long long int</td><td>C.ulonglong</td><td>uint64</td></tr><tr><td>float</td><td>C.float</td><td>float32</td></tr><tr><td>double</td><td>C.double</td><td>float64</td></tr><tr><td>size_t</td><td>C.size_t</td><td>uint</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="准备就绪开始嵌入">准备就绪，开始嵌入<a class="hash-link" href="#准备就绪开始嵌入" title="Direct link to heading">​</a></h2><p>待补充</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="ref-doc">参考文档<a class="hash-link" href="#ref-doc" title="Direct link to heading">​</a></h2><ul><li>pkg-config<ul><li><a href="https://people.freedesktop.org/~dbn/pkg-config-guide.html" target="_blank" rel="noopener noreferrer">Guide to pkg-config</a></li><li><a href="https://askubuntu.com/questions/210210/pkg-config-path-environment-variable" target="_blank" rel="noopener noreferrer">PKG_CONFIG_PATH environment variable</a></li></ul></li><li>Embed Python into Go<ul><li>google：<code>embedding python in go</code></li><li><a href="https://docs.python.org/zh-cn/3/extending/embedding.html" target="_blank" rel="noopener noreferrer">Python 官方文档：在其它应用程序嵌入 Python</a></li><li><a href="https://www.ardanlabs.com/blog/2020/06/python-go-grpc.html" target="_blank" rel="noopener noreferrer">2020.6 - Python and Go ： Part I - gRPC</a><ul><li>这是有 4 篇的系列文章，分别讲述了 1.go-grpc-python、2.python-c-go、3.python 打包、4.go-内存共享-python —— 尤其是 1、4 都非常有创意，我受益匪浅。</li></ul></li><li><a href="https://poweruser.blog/embedding-python-in-go-338c0399f3d5" target="_blank" rel="noopener noreferrer">2020.10 - Embedding Python in Go</a></li><li><a href="https://linux.cn/article-13564-1.html" target="_blank" rel="noopener noreferrer">2021.7 - 如何在 Go 中嵌入 Python</a></li></ul></li><li>Embed Go into Python<ul><li><a href="https://hackernoon.com/extending-python-3-in-go-78f3a69552ac" target="_blank" rel="noopener noreferrer">2017.12 - Extending Python 3 in Go</a><ul><li>文章名字与内容不符，应该是 Extending Python3 with go，但内容写的还是不错的</li></ul></li><li><a href="https://www.nathanvangheem.com/posts/2017/06/03/embedding-golang-in-python-with-groupcache.html" target="_blank" rel="noopener noreferrer">2017.6 - Embedding Go and groupcache in Python</a></li></ul></li><li>cgo<ul><li>官方文档：<a href="https://pkg.go.dev/cmd/cgo" target="_blank" rel="noopener noreferrer">cmd/cgo</a>、<a href="https://pkg.go.dev/runtime/cgo" target="_blank" rel="noopener noreferrer">runtime/cgo</a></li><li><a href="https://books.studygolang.com/advanced-go-programming-book/ch2-cgo/readme.html" target="_blank" rel="noopener noreferrer">第 2 章 CGO 编程</a><ul><li><a href="https://books.studygolang.com/advanced-go-programming-book/" target="_blank" rel="noopener noreferrer">《Go 语言高级编程(Advanced Go Programming)》- 2019</a> 的第 2 章，内容完整，篇幅较长，并且中文，两位作者都是 Go 语言最早期国内推广者。</li><li>文首一句<code>过去的经验往往是走向未来的枷锁，因为在过气技术中投入的沉没成本会阻碍人们拥抱新技术。——chai2010</code>说的是 C++ 该放弃了，尤其是为了兼容 C 还在迁就使用 C++ 的同学该醒悟了，哈哈，是不是感觉受到了暴击！</li></ul></li><li><a href="https://cloud.tencent.com/developer/article/1650525" target="_blank" rel="noopener noreferrer">2020.6 - CGO 和 CGO 性能之谜</a><ul><li>先报了 cgo 的黑料（不能交叉编译、性能……），然后用个小例子说明了 cgo 的原理，然后弄了个大例子说明性能损耗在真实情况下可以忽略不计，最后推荐了一些使用 cgo 的开源项目。—— 很棒的一篇文章！</li></ul></li><li><a href="https://golang.design/under-the-hood/zh-cn/part3tools/ch11compile/cgo/" target="_blank" rel="noopener noreferrer">13.10 cgo</a><ul><li><a href="https://golang.design/under-the-hood/" target="_blank" rel="noopener noreferrer">《Go 语言原本》- 2018</a>中的一个章节，本书是 Go 源码解读系列，作者是 B 站 Go 夜读的发起人和网友们。</li><li>但此章节非常简短，只是贬低了一下 cgo，并且由于撰写时已年代久远，应该已经不足为据。</li></ul></li><li><a href="https://go.dev/blog/cgo" target="_blank" rel="noopener noreferrer">2011.3 - C? Go? Cgo!</a><ul><li>go 官方网站上的一篇博客文章，2011 年，OMG，11 年前的文章，但百度上的很多水文都 copy 了这篇，一直 copy 到 2022 年。</li></ul></li></ul></li></ul></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/python">python</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/go">go</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2022/05/19/vscode.wordwrap.lindwidth"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">VSCode 中的显示换行和格式化换行</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#python-的-extending-和-embedding" class="table-of-contents__link toc-highlight">Python 的 Extending 和 Embedding</a></li><li><a href="#让-gcc-找到-python" class="table-of-contents__link toc-highlight">让 gcc 找到 python</a><ul><li><a href="#pkg-config" class="table-of-contents__link toc-highlight">pkg-config</a></li><li><a href="#python-的-pkg-config-数据" class="table-of-contents__link toc-highlight">python 的 pkg-config 数据</a></li><li><a href="#python-的-flag-还能这样获取" class="table-of-contents__link toc-highlight">python 的 flag 还能这样获取</a></li></ul></li><li><a href="#python-c-api" class="table-of-contents__link toc-highlight">Python C API</a></li><li><a href="#cgo" class="table-of-contents__link toc-highlight">cgo</a></li><li><a href="#准备就绪开始嵌入" class="table-of-contents__link toc-highlight">准备就绪，开始嵌入</a></li><li><a href="#ref-doc" class="table-of-contents__link toc-highlight">参考文档</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a href="http://weibo.com/wkevin27" target="_blank" rel="noopener noreferrer" class="footer__link-item">微博</a></li><li class="footer__item"><a href="https://twitter.com/wkevin27" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://gitee.com/wkevin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee</a></li><li class="footer__item"><a href="https://blog.csdn.net/kevin881" target="_blank" rel="noopener noreferrer" class="footer__link-item">CSDN</a></li></ul></div><div class="col footer__col"><div class="footer__title">Awesome</div><ul class="footer__items"><li class="footer__item"><a href="https://arxiv.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Arxiv</a></li><li class="footer__item"><a href="https://www.tianlangbooks.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">天浪书屋</a></li><li class="footer__item"><a href="https://yts.mx/" target="_blank" rel="noopener noreferrer" class="footer__link-item">YTS</a></li></ul></div><div class="col footer__col"><div class="footer__title">Collaborate</div><ul class="footer__items"><li class="footer__item"><a href="https://mubu.com/app" target="_blank" rel="noopener noreferrer" class="footer__link-item">幕布</a></li><li class="footer__item"><a href="https://shimo.im/" target="_blank" rel="noopener noreferrer" class="footer__link-item">石墨</a></li><li class="footer__item"><a href="https://www.feishu.cn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">飞书</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 wkevin, built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.cf3587f7.js"></script>
<script src="/assets/js/main.8fa2c20d.js"></script>
</body>
</html>