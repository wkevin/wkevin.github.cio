"use strict";(self.webpackChunkdocusaurus_site=self.webpackChunkdocusaurus_site||[]).push([[3794],{3905:function(e,n,t){t.d(n,{Zo:function(){return s},kt:function(){return v}});var i=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=i.createContext({}),c=function(e){var n=i.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},s=function(e){var n=c(e.components);return i.createElement(p.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},u=i.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=c(t),v=r,m=u["".concat(p,".").concat(v)]||u[v]||d[v]||o;return t?i.createElement(m,a(a({ref:n},s),{},{components:t})):i.createElement(m,a({ref:n},s))}));function v(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,a=new Array(o);a[0]=u;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,a[1]=l;for(var c=2;c<o;c++)a[c]=t[c];return i.createElement.apply(null,a)}return i.createElement.apply(null,t)}u.displayName="MDXCreateElement"},15739:function(e,n,t){t.r(n),t.d(n,{assets:function(){return s},contentTitle:function(){return p},default:function(){return v},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return d}});var i=t(87462),r=t(63366),o=(t(67294),t(3905)),a=["components"],l={title:"Opencv4.0 \u5b89\u88c5\u811a\u672c",date:"2018-12-14 15:08:53 +0800",description:" ",authors:"wKevin",categories:["ai","cv"],tags:["opencv","ubuntu"]},p=void 0,c={permalink:"/blog/2018/12/14/build.and.install.opencv",source:"@site/blog/2018-12-14-build.and.install.opencv/index.md",title:"Opencv4.0 \u5b89\u88c5\u811a\u672c",description:" ",date:"2018-12-14T15:08:53.000Z",formattedDate:"December 14, 2018",tags:[{label:"opencv",permalink:"/blog/tags/opencv"},{label:"ubuntu",permalink:"/blog/tags/ubuntu"}],truncated:!1,authors:[{name:"Kevin Wang",title:"ZTEr",url:"http://wkevin.github.io/",imageURL:"/img/avastar/angry.bird.jpg",key:"wKevin"}],frontMatter:{title:"Opencv4.0 \u5b89\u88c5\u811a\u672c",date:"2018-12-14 15:08:53 +0800",description:" ",authors:"wKevin",categories:["ai","cv"],tags:["opencv","ubuntu"]},prevItem:{title:"\u4f7f\u7528 Mkdocs \u5236\u4f5c\u9879\u76ee\u6587\u6863",permalink:"/blog/2018/12/17/mkdocs.to.project.doc"},nextItem:{title:"\u8d60\u82b1\u537f",permalink:"/blog/2018/12/13/Have.a.rest"}},s={authorsImageUrls:[void 0]},d=[{value:"\u53c2\u6570\u89e3\u6790",id:"\u53c2\u6570\u89e3\u6790",level:2},{value:"\u5b89\u88c5\u4f9d\u8d56\u5305",id:"\u5b89\u88c5\u4f9d\u8d56\u5305",level:2},{value:"\u5b89\u88c5 Python \u53ca\u865a\u62df\u73af\u5883",id:"\u5b89\u88c5-python-\u53ca\u865a\u62df\u73af\u5883",level:2},{value:"\u4e0b\u8f7d opencv \u6e90\u7801",id:"\u4e0b\u8f7d-opencv-\u6e90\u7801",level:2},{value:"\u7f16\u8bd1 opencv",id:"\u7f16\u8bd1-opencv",level:2},{value:"\u7f16\u8bd1\u7ed3\u679c",id:"\u7f16\u8bd1\u7ed3\u679c",level:2}],u={toc:d};function v(e){var n=e.components,l=(0,r.Z)(e,a);return(0,o.kt)("wrapper",(0,i.Z)({},u,l,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:t(68252).Z},"\u5b8c\u6574\u811a\u672c\u4e0b\u8f7d")),(0,o.kt)("h2",{id:"\u53c2\u6570\u89e3\u6790"},"\u53c2\u6570\u89e3\u6790"),(0,o.kt)("p",null,"\u6211\u8bbe\u7f6e\u4e86 3 \u4e2a\u53c2\u6570:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--cvversion"),": \u6307\u5b9a opencv \u7684\u5f85\u7f16\u8bd1\u7248\u672c"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--pippkg"),": \u7531\u4e8e\u6211\u5728\u516c\u53f8 proxy \u540e\u9762\uff0c\u4e0d\u5e0c\u671b\u6bcf\u6b21\u90fd\u4e0b\u8f7d\uff0c\u6240\u4ee5\u4e8b\u5148\u7528 ",(0,o.kt)("inlineCode",{parentName:"li"},"pip download")," \u4e0b\u8f7d\u597d\uff0c\u8fd9\u91cc\u6307\u5b9a\u8fdb\u53bb\uff0c\u5982\u679c\u4e0d\u62c5\u5fc3\u6d41\u91cf\u95ee\u9898\uff0c\u53ef\u5ffd\u7565"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--pre"),": \u6211\u628a\u6b64\u811a\u672c\u5206\u4e24\u5927\u90e8\u5206\uff0c\u51c6\u5907\u73af\u5883\u3001\u7f16\u8bd1\u3002\u73af\u5883\u53ea\u9700\u4e00\u6b21\uff0c\u7f16\u8bd1\u53ef\u80fd\u591a\u6b21\uff0c\u6b64\u53c2\u6570\u662f\u8df3\u8fc7\u51c6\u5907\u73af\u5883\u6b65\u9aa4\u3002")),(0,o.kt)("p",null,"\u4e3e\u4f8b: ",(0,o.kt)("inlineCode",{parentName:"p"},"$ build.anf.install.opencv.sh --cvversion 4.0.0 --pippkg /var/pippkg/ --pre false")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'cvVersion="master"\nPipArg="-i https://mirrors.ustc.edu.cn/pypi/web/simple "\nif [ "$http_proxy" ]; then\n    PipArg=$PipArg" --proxy "$http_proxy\nfi\npre=""\n\nwhile [ $# -ge 2 ];\ndo\n    case "$1" in\n        --cvversion) cvVersion=$2 ; shift 2;;\n        --pippkg) PipArg="--no-index -f $2" ; shift 2;;\n        --pre) pre=$2; shift 2;;\n        *) echo "unknown parameter $1"; exit 1; break;;\n    esac\ndone\n\necho "============================"\necho "cvVersion: $cvVersion"\necho "PipArg: $PipArg"\necho "doPrepare: $pre"\necho "============================"\n\ncwd=$(pwd)\nvenvname=py3venv_build_opencv-"$cvVersion"\n')),(0,o.kt)("h2",{id:"\u5b89\u88c5\u4f9d\u8d56\u5305"},"\u5b89\u88c5\u4f9d\u8d56\u5305"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"## Update Packages\nsudo apt -y update\nsudo apt -y upgrade\n\nsudo apt -y remove x264 libx264-dev\n\n## Install dependencies\nsudo apt -y install build-essential checkinstall cmake pkg-config yasm\nsudo apt -y install git gfortran\nsudo apt -y install libjpeg8-dev libjasper-dev libpng12-dev\n\nsudo apt -y install libtiff5-dev\n\nsudo apt -y install libtiff-dev\n\nsudo apt -y install libavcodec-dev libavformat-dev libswscale-dev libdc1394-22-dev\nsudo apt -y install libxine2-dev libv4l-dev\ncd /usr/include/linux\nsudo ln -s -f ../libv4l1-videodev.h videodev.h\ncd $cwd\n\nsudo apt -y install libgstreamer0.10-dev libgstreamer-plugins-base0.10-dev\nsudo apt -y install libgtk2.0-dev libtbb-dev qt5-default\nsudo apt -y install libatlas-base-dev\nsudo apt -y install libfaac-dev libmp3lame-dev libtheora-dev\nsudo apt -y install libvorbis-dev libxvidcore-dev\nsudo apt -y install libopencore-amrnb-dev libopencore-amrwb-dev\nsudo apt -y install libavresample-dev\nsudo apt -y install x264 v4l-utils\n\n# Optional dependencies\nsudo apt -y install libprotobuf-dev protobuf-compiler\nsudo apt -y install libgoogle-glog-dev libgflags-dev\nsudo apt -y install libgphoto2-dev libeigen3-dev libhdf5-dev doxygen\n")),(0,o.kt)("h2",{id:"\u5b89\u88c5-python-\u53ca\u865a\u62df\u73af\u5883"},"\u5b89\u88c5 Python \u53ca\u865a\u62df\u73af\u5883"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'## Install Python Libraries\nsudo apt -y install python3-dev python3-pip\nsudo -H pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple --proxy http://proxysz.zte.com.cn:80 -U pip numpy\nsudo apt -y install python3-testresources\n\n# create virtual environment\ncd $cwd\nif [ ! -d $venvname ]; then\n    python3 -m venv $venvname\nfi\nsource "$cwd"/$venvname/bin/activate\npip install $PipArg -U pip\npip install $PipArg wheel numpy scipy matplotlib scikit-image scikit-learn ipython dlib\ndeactivate\n')),(0,o.kt)("h2",{id:"\u4e0b\u8f7d-opencv-\u6e90\u7801"},"\u4e0b\u8f7d opencv \u6e90\u7801"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'## Download scr\nif [ ! -d "opencv.git" ]; then\n    git clone https://github.com/opencv/opencv.git opencv.git\nfi\ncd opencv.git\ngit checkout $cvVersion\ncd ..\n\nif [ ! -d "opencv_contrib.git" ]; then\n    git clone https://github.com/opencv/opencv_contrib.git opencv_contrib.git\nfi\ncd opencv_contrib.git\ngit checkout $cvVersion\ncd ..\n')),(0,o.kt)("h2",{id:"\u7f16\u8bd1-opencv"},"\u7f16\u8bd1 opencv"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'cd opencv.git\nif [ ! -d "build" ]; then\n    mkdir build\nfi\ncd build\nstarttime=`date +\'%Y-%m-%d %H:%M:%S\'`\nopts="-D CMAKE_BUILD_TYPE=RELEASE \\\n      -D CMAKE_INSTALL_PREFIX=$cwd/installation/OpenCV-"$cvVersion" \\\n      -D WITH_QT=ON \\\n      -D WITH_TBB=ON \\\n      -D WITH_V4L=ON \\\n      -D WITH_PNG=ON \\\n      -D WITH_JPEG=ON \\\n      -D WITH_OPENGL=ON \\\n      -D BUILD_EXAMPLES=OFF \\\n      -D OPENCV_PYTHON3_INSTALL_PATH=$cwd/$venvname/lib/python3.5/site-packages \\\n      -D OPENCV_EXTRA_MODULES_PATH=../../opencv_contrib.git/modules \\\n      -D BUILD_opencv_world=OFF "\ncmake $opts ..\nmake -j8\nendtime=`date +\'%Y-%m-%d %H:%M:%S\'`\nstart_seconds=$(date --date="$starttime" +%s);\nend_seconds=$(date --date="$endtime" +%s);\necho "\u672c\u6b21\u8fd0\u884c\u65f6\u95f4\uff1a "$((end_seconds-start_seconds))"s"\nmake install\ncd $cwd\n')),(0,o.kt)("h2",{id:"\u7f16\u8bd1\u7ed3\u679c"},"\u7f16\u8bd1\u7ed3\u679c"),(0,o.kt)("p",null,"\u811a\u672c\u4e2d\u9ed8\u8ba4\u7f16\u8bd1\u4e86 opencv_contrib\uff0c\u5219\u6700\u7ec8\u751f\u6210\u7684 modules \u4f1a\u591a\u5f88\u591a\uff0c\u6211\u5bf9\u6709\u65e0 ",(0,o.kt)("inlineCode",{parentName:"p"},"-D OPENCV_EXTRA_MODULES_PATH")," \u505a\u4e86\u5bf9\u6bd4"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u6700\u7ec8\u5b89\u88c5\u5230 python \u73af\u5883\u7684 cv2.cpython-35m-x86_64-linux-gnu.so \u6587\u4ef6\uff1a3.9M\u30016.8M"),(0,o.kt)("li",{parentName:"ul"},"build \u6587\u4ef6\u5939\u4f53\u79ef\uff1a\u5206\u522b\u662f 5G\u300112G",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"\u5176\u4e2d modules \u6587\u4ef6\u5939\u5dee\u5f02\u6700\u5927\uff0c\u5982\u4e0b\u56fe\uff1a")))),(0,o.kt)("p",null,(0,o.kt)("img",{src:t(69493).Z,width:"941",height:"890"})))}v.isMDXComponent=!0},68252:function(e,n,t){n.Z=t.p+"assets/files/build.and.install.opencv-814eec82d6cee8dd7e97f1492ce23d55.sh"},69493:function(e,n,t){n.Z=t.p+"assets/images/compare-91f2d08d036893090ac931702f5f009f.png"}}]);